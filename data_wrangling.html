

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Data wrangling &#8212; ICESat-2 Sea Ice Thickness Data Analysis and Visualization</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-dropdown.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="_static/logo.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Sea ice drift" href="ice_drift.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">ICESat-2 Sea Ice Thickness Data Analysis and Visualization</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="home.html">
   ICESat-2 Sea Ice Thickness Data Analysis and Visualization
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  NOTEBOOKS
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="mapping.html">
   Mapping
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="regional_analysis.html">
   Regional analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="winter_comparison.html">
   Winter comparison
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="winter_ice_growth.html">
   Winter sea ice growth
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="PIOMAS.html">
   Historical ice thickness
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ice_drift.html">
   Sea ice drift
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  MISC
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Data wrangling
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/data_wrangling.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/nicolejkeeney/icesat2-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/nicolejkeeney/icesat2-book/issues/new?title=Issue%20on%20page%20%2Fdata_wrangling.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/nicolejkeeney/icesat2-book/edit/master/data_wrangling.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/nicolejkeeney/icesat2-book/master?urlpath=tree/data_wrangling.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/nicolejkeeney/icesat2-book/blob/master/data_wrangling.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#import-notebook-dependencies">
   Import notebook dependencies
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#define-filepaths">
   Define filepaths
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#load-in-data">
   Load in data
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#set-desired-date-range-for-data">
     Set desired date range for data
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#define-a-function-to-get-winter-date-range">
       Define a function to get winter date range
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#call-function">
       Call function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#icesat-2-monthly-gridded-sea-ice-data">
     ICESat-2 monthly gridded sea ice data
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#define-function-to-load-data">
       Define function to load data
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       Call function
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#clean-data-and-extract-useful-variables">
       Clean data and extract useful variables
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#nsidc-sea-ice-concentration-data">
     NSIDC sea ice concentration data
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id2">
       Define function to load data
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id3">
       Call function
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#clean-data">
       Clean data
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#nsidc-region-mask-for-the-arctic-data">
     NSIDC region mask for the Arctic data
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id4">
       Define function to load data
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id5">
       Call function
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#define-descriptive-information">
       Define descriptive information
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#era5-climate-reanalysis-data">
     ERA5 climate reanalysis data
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id6">
       Clean data
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#piomas-sea-ice-thickness-data">
     PIOMAS sea ice thickness data
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#define-function-to-load-the-data">
       Define function to load the data
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id7">
       Call function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#nsidc-sea-ice-drift-data">
     NSIDC sea ice drift data
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id8">
       Define function to load the data
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id9">
       Call function
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#restrict-data-to-winter-months">
       Restrict data to winter months
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#interpolate-missing-icesat-2-data">
   Interpolate missing ICESat-2 data
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#add-descriptive-attributes-coordinates-to-all-icesat-2-variables">
     Add descriptive attributes &amp; coordinates to all ICESat-2 variables
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#regrid-additional-datasets-to-icesat-2-grid">
   Regrid additional datasets to ICESat-2 grid
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#define-regridding-function">
     Define regridding function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#regrid-era5-data">
     Regrid ERA5 data
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#choose-data-variables-of-interest">
       Choose data variables of interest
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#regrid-era5-data-add-to-icesat-2-dataset">
       Regrid ERA5 data &amp; add to ICESat-2 dataset
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#regrid-piomas-data">
     Regrid PIOMAS data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#regrid-nsidc-sea-ice-drift-data">
     Regrid NSIDC sea ice drift data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#save-regridded-piomas-file-to-local-directory">
     Save regridded PIOMAS file to local directory
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#add-winter-regridded-piomas-data-to-icesat-2-dataset">
     Add winter regridded PIOMAS data to ICESat-2 dataset
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#compile-datasets-into-a-single-dataset">
   Compile datasets into a single Dataset
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#save-dataset-to-your-local-machine">
   Save dataset to your local machine
  </a>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="data-wrangling">
<h1>Data wrangling<a class="headerlink" href="#data-wrangling" title="Permalink to this headline">¶</a></h1>
<p>This notebook loads the different datasets used in the analysis into a single NETCDF4 file, with descriptive attributes maintained for each dataset. The datasets used in this notebook are listed below. The output file is accessible in the google bucket for this jupyter book and loaded in each notebook.</p>
<p><strong>Input</strong>:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://icesat-2.gsfc.nasa.gov/sea-ice-thickness-data">ICESat-2 monthly gridded sea ice data</a></p></li>
<li><p><a class="reference external" href="https://nsidc.org/data/g02202">Monthly NSIDC sea ice concentration data</a></p></li>
<li><p><a class="reference external" href="https://nsidc.org/data/polar-stereo/tools_masks.html#region_masks">NSIDC region mask</a> and <a class="reference external" href="https://nsidc.org/data/polar-stereo/tools_geo_pixel.html">coordinate</a> tools (psn25 v3)</p></li>
<li><p><a class="reference external" href="https://cds.climate.copernicus.eu/cdsapp#%21/dataset/reanalysis-era5-single-levels-monthly-means?tab=overview">ERA 5 climate renanalysis data</a></p></li>
<li><p><a class="reference external" href="http://psc.apl.uw.edu/research/projects/arctic-sea-ice-volume-anomaly/">PIOMAS mean monthly ice thickness</a></p></li>
<li><p><a class="reference external" href="https://nsidc.org/data/nsidc-0116">NSIDC sea ice motion vectors</a></p></li>
</ul>
<p><strong>Output</strong>:</p>
<ul class="simple">
<li><p>NETCDF4 file</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This notebook is <strong>NOT</strong> configured to run in Google Colab. This file generated by this notebook is also provided google bucket for this book. <a class="reference external" href="https://storage.googleapis.com/icesat2-book-data/icesat2-book-dataset.nc">Click here</a> to download the dataset.</p>
</div>
<div class="section" id="import-notebook-dependencies">
<h2>Import notebook dependencies<a class="headerlink" href="#import-notebook-dependencies" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">numpy.ma</span> <span class="k">as</span> <span class="nn">ma</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">scipy.interpolate</span>
<span class="kn">import</span> <span class="nn">pyproj</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">date</span>
<span class="kn">from</span> <span class="nn">glob</span> <span class="kn">import</span> <span class="n">glob</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="c1"># Ignore warnings in the notebook to improve display</span>
<span class="c1"># You might want to remove this when debugging/writing new code</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="define-filepaths">
<h2>Define filepaths<a class="headerlink" href="#define-filepaths" title="Permalink to this headline">¶</a></h2>
<p>Define filepaths to data on your local machine</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#path to monthly gridded ICESat-2 data</span>
<span class="n">IS2_path</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

<span class="c1">#path to NSIDC weekly sea ice concentration data</span>
<span class="n">SIC_path</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

<span class="c1">#path to NSIDC region mask for the Arctic</span>
<span class="n">regionMask_path</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

<span class="c1">#path to ERA5 climate reanalysis data </span>
<span class="n">ERA5_path</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

<span class="c1">#path to PIOMAS data</span>
<span class="n">PIOMAS_path</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

<span class="c1">#path to NSIDC sea ice drift data </span>
<span class="n">drift_path</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="load-in-data">
<h2>Load in data<a class="headerlink" href="#load-in-data" title="Permalink to this headline">¶</a></h2>
<div class="section" id="set-desired-date-range-for-data">
<h3>Set desired date range for data<a class="headerlink" href="#set-desired-date-range-for-data" title="Permalink to this headline">¶</a></h3>
<div class="section" id="define-a-function-to-get-winter-date-range">
<h4>Define a function to get winter date range<a class="headerlink" href="#define-a-function-to-get-winter-date-range" title="Permalink to this headline">¶</a></h4>
<p>Since we are interested in winter sea ice growth, we’ll want to restrict our datasets to only get winter data. Winter is defined as the months of November, December, January, February, March, and April.</p>
<ul class="simple">
<li><p>This function is also defined in the mapping notebook</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getWinterDateRange</span><span class="p">(</span><span class="n">start_year</span><span class="p">,</span> <span class="n">end_year</span><span class="p">):</span> 
    <span class="sd">&quot;&quot;&quot; Gets date range for winter season/s</span>
<span class="sd">    Args: </span>
<span class="sd">        start_year (int): start year </span>
<span class="sd">        end_year (int): end year </span>
<span class="sd">        </span>
<span class="sd">    Returns: </span>
<span class="sd">        winters (list): list of dates for all winter seasons in the input range (i.e: [&#39;1980-11&#39;,&#39;1980-12&#39;,&#39;1981-01&#39;,</span>
<span class="sd">         &#39;1981-02&#39;,&#39;1981-03&#39;,&#39;1981-04&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">winters</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start_year</span><span class="p">,</span> <span class="n">end_year</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">winters</span> <span class="o">+=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;-11&#39;</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">year</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;-04&#39;</span><span class="p">,</span> <span class="n">freq</span> <span class="o">=</span> <span class="s1">&#39;MS&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">winters</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="call-function">
<h4>Call function<a class="headerlink" href="#call-function" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">startYear</span> <span class="o">=</span> <span class="mi">2018</span>
<span class="n">endYear</span> <span class="o">=</span> <span class="mi">2020</span>
<span class="n">winters</span> <span class="o">=</span> <span class="n">getWinterDateRange</span><span class="p">(</span><span class="n">startYear</span><span class="p">,</span> <span class="n">endYear</span><span class="p">)</span> <span class="c1">#get date range for winter 18-19 and winter 19-20</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="icesat-2-monthly-gridded-sea-ice-data">
<h3>ICESat-2 monthly gridded sea ice data<a class="headerlink" href="#icesat-2-monthly-gridded-sea-ice-data" title="Permalink to this headline">¶</a></h3>
<div class="section" id="define-function-to-load-data">
<h4>Define function to load data<a class="headerlink" href="#define-function-to-load-data" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getIS2Data</span><span class="p">(</span><span class="n">dataPath</span><span class="p">,</span> <span class="n">dates</span><span class="p">):</span> 
    <span class="sd">&quot;&quot;&quot;Gets ICESat-2 data for provided date range</span>
<span class="sd">    </span>
<span class="sd">    Args: </span>
<span class="sd">        dataPath (str): path to local directory of ICESat-2 data </span>
<span class="sd">        dates (list): pandas Timestamp objects generated by getWinterDateRange</span>
<span class="sd">        </span>
<span class="sd">    Returns: </span>
<span class="sd">        is2 (xarray dataset): ICESat-2 data or NONE if file does not exist for inputted date range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">is2List</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list for compiling xarray DataArray objects</span>
    <span class="k">for</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">dates</span><span class="p">:</span> 
        <span class="k">try</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="n">glob</span><span class="p">(</span><span class="n">dataPath</span><span class="o">+</span> <span class="s1">&#39;IS2*&#39;</span> <span class="o">+</span> <span class="n">date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%y&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%m&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;*.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span> 
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Cannot find files; check date range, filepath or if glob is imported&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">is2</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="n">is2</span> <span class="o">=</span> <span class="n">is2</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">({</span><span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="n">date</span><span class="p">})</span>
        <span class="n">is2List</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">is2</span><span class="p">)</span>
    <span class="n">is2Data</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">is2List</span><span class="p">,</span> <span class="n">dim</span> <span class="o">=</span> <span class="s1">&#39;time&#39;</span><span class="p">)</span> <span class="c1">#concatenate all DataArray objects into a single DataArray</span>
    
    <span class="k">return</span> <span class="n">is2Data</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id1">
<h4>Call function<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">is2</span> <span class="o">=</span> <span class="n">getIS2Data</span><span class="p">(</span><span class="n">IS2_path</span><span class="p">,</span> <span class="n">winters</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="clean-data-and-extract-useful-variables">
<h4>Clean data and extract useful variables<a class="headerlink" href="#clean-data-and-extract-useful-variables" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#drop projection variable </span>
<span class="n">is2</span> <span class="o">=</span> <span class="n">is2</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;projection&#39;</span><span class="p">)</span>

<span class="c1">#get lat and lon</span>
<span class="n">is2Lats</span> <span class="o">=</span> <span class="n">is2</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
<span class="n">is2Lons</span> <span class="o">=</span> <span class="n">is2</span><span class="o">.</span><span class="n">longitude</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
<span class="n">is2LonsAttrs</span> <span class="o">=</span> <span class="n">is2</span><span class="o">.</span><span class="n">longitude</span><span class="o">.</span><span class="n">attrs</span> 
<span class="n">is2LatsAttrs</span> <span class="o">=</span> <span class="n">is2</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">attrs</span>

<span class="c1">#assign lat and lon as coordinates to dataset</span>
<span class="n">is2</span> <span class="o">=</span> <span class="n">is2</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">coords</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;latitude&#39;</span><span class="p">:</span> <span class="p">((</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">is2Lats</span><span class="p">),</span> <span class="s1">&#39;longitude&#39;</span><span class="p">:</span> <span class="p">((</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">is2Lons</span><span class="p">)})</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="nsidc-sea-ice-concentration-data">
<h3>NSIDC sea ice concentration data<a class="headerlink" href="#nsidc-sea-ice-concentration-data" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id2">
<h4>Define function to load data<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getSICData</span><span class="p">(</span><span class="n">dataPath</span><span class="p">,</span> <span class="n">dates</span><span class="p">):</span> 
    <span class="sd">&quot;&quot;&quot;Gets sea ice concentration data for provided date range</span>
<span class="sd">    </span>
<span class="sd">    Args: </span>
<span class="sd">        dataPath (str): path to local directory of sea ice concentration data </span>
<span class="sd">        dates (list): pandas Timestamp objects generated by getWinterDateRange</span>
<span class="sd">        </span>
<span class="sd">    Returns: </span>
<span class="sd">        sicData (xarray dataset): sea ice concentration data or NONE if file does not exist for inputted date range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sicList</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list for compiling xarray DataArray objects</span>
    <span class="k">for</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">dates</span><span class="p">:</span> 
        <span class="k">try</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="n">glob</span><span class="p">(</span><span class="n">dataPath</span><span class="o">+</span> <span class="s1">&#39;seaice_conc_monthly*&#39;</span> <span class="o">+</span> <span class="n">date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%m&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;*.nc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span> 
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Cannot find files; check date range, filepath or if glob is imported&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">dropVariables</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;goddard_merged_seaice_conc_monthly&#39;</span><span class="p">,</span><span class="s1">&#39;goddard_bt_seaice_conc_monthly&#39;</span><span class="p">,</span> <span class="s1">&#39;goddard_nt_seaice_conc_monthly&#39;</span><span class="p">]</span>
        <span class="n">sicList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">drop_variables</span> <span class="o">=</span> <span class="n">dropVariables</span><span class="p">))</span>
    <span class="n">sicData</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">sicList</span> <span class="p">,</span> <span class="n">dim</span> <span class="o">=</span> <span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">combine_attrs</span> <span class="o">=</span> <span class="s1">&#39;override&#39;</span><span class="p">,</span> <span class="n">data_vars</span> <span class="o">=</span> <span class="s1">&#39;minimal&#39;</span><span class="p">)</span> <span class="c1">#concatenate all DataArray objects into a single DataArray</span>
    
    <span class="k">return</span> <span class="n">sicData</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id3">
<h4>Call function<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sic</span> <span class="o">=</span> <span class="n">getSICData</span><span class="p">(</span><span class="n">SIC_path</span><span class="p">,</span> <span class="n">winters</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="clean-data">
<h4>Clean data<a class="headerlink" href="#clean-data" title="Permalink to this headline">¶</a></h4>
<p>Clean data by removing flagged data and filling the pole hole. We assume concentration is 100% within the pole hole because we are only looking at winter data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#remove flagged data </span>
<span class="n">sic_monthly_cdr</span> <span class="o">=</span> <span class="n">sic</span><span class="p">[</span><span class="s1">&#39;seaice_conc_monthly_cdr&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">sic</span><span class="p">[</span><span class="s1">&#39;seaice_conc_monthly_cdr&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1">#fill pole hole as 100% concentration</span>
<span class="n">sic_monthly_cdr</span> <span class="o">=</span> <span class="n">sic</span><span class="p">[</span><span class="s1">&#39;seaice_conc_monthly_cdr&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">sic</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1">#reassign variable</span>
<span class="n">sic</span> <span class="o">=</span> <span class="n">sic</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">seaice_conc_monthly_cdr</span> <span class="o">=</span> <span class="n">sic_monthly_cdr</span><span class="p">)</span>

<span class="c1">#reassign dimensions </span>
<span class="n">seaice_conc_monthly_cdr</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">sic</span><span class="p">[</span><span class="s1">&#39;seaice_conc_monthly_cdr&#39;</span><span class="p">],</span> <span class="n">dims</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">coords</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="n">winters</span><span class="p">,</span> <span class="s1">&#39;latitude&#39;</span><span class="p">:</span> <span class="p">((</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">is2Lats</span><span class="p">),</span> <span class="s1">&#39;longitude&#39;</span><span class="p">:</span> <span class="p">((</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">is2Lons</span><span class="p">)})</span> 

<span class="c1">#attributes from entire NSIDC data to maintain</span>
<span class="n">desiredSICAttrs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;references&#39;</span><span class="p">,</span> <span class="s1">&#39;contributor_name&#39;</span><span class="p">,</span> <span class="s1">&#39;license&#39;</span><span class="p">,</span> <span class="s1">&#39;summary&#39;</span><span class="p">]</span> <span class="c1">#attributes to maintain from entire sea ice concentration dataset</span>
<span class="n">SICDatasetAttrs</span> <span class="o">=</span> <span class="p">{</span><span class="n">x</span><span class="p">:</span><span class="n">sic</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">desiredSICAttrs</span><span class="p">}</span>
<span class="n">seaice_conc_monthly_cdr</span> <span class="o">=</span> <span class="n">seaice_conc_monthly_cdr</span><span class="o">.</span><span class="n">assign_attrs</span><span class="p">(</span><span class="n">SICDatasetAttrs</span><span class="p">)</span>

<span class="c1">#add to is2 dataset </span>
<span class="n">is2</span><span class="p">[</span><span class="s1">&#39;seaice_conc_monthly_cdr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">seaice_conc_monthly_cdr</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="nsidc-region-mask-for-the-arctic-data">
<h3>NSIDC region mask for the Arctic data<a class="headerlink" href="#nsidc-region-mask-for-the-arctic-data" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id4">
<h4>Define function to load data<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getRegionMask</span><span class="p">(</span><span class="n">dataPath</span><span class="p">):</span> 
    <span class="sd">&quot;&quot;&quot;Gets NSIDC region mask for map projection</span>
<span class="sd">    </span>
<span class="sd">     Args:</span>
<span class="sd">         dataPath (str): path to NSIDC region mask</span>
<span class="sd">         </span>
<span class="sd">     Returns: </span>
<span class="sd">         shapedMask (numpy array): NSIDC arctic region mask gridded to shape [448, 304]</span>
<span class="sd">         shapedLons (numpy array): longitudes gridded to shape [448, 304]</span>
<span class="sd">         shapedLats (numpy array): latitudes gridded to shape [448, 304] </span>
<span class="sd">    &quot;&quot;&quot;</span> 
    <span class="n">gridShape</span> <span class="o">=</span> <span class="p">[</span><span class="mi">448</span><span class="p">,</span> <span class="mi">304</span><span class="p">]</span> <span class="c1">#shape of grid to reshape data to </span>
    
    <span class="n">regionMask</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">dataPath</span> <span class="o">+</span> <span class="s1">&#39;/sect_fixed_n.msk&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="c1">#open region mask </span>
    <span class="n">shapedMask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="n">file</span> <span class="o">=</span> <span class="n">regionMask</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;uint8&#39;</span><span class="p">),</span> <span class="n">gridShape</span><span class="p">)</span> <span class="c1">#reshape mask to grid shape</span>
    
    <span class="n">maskLons</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">dataPath</span> <span class="o">+</span> <span class="s1">&#39;/psn25lons_v3.dat&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="c1">#open region mask longitudes</span>
    <span class="n">maskLats</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">dataPath</span> <span class="o">+</span> <span class="s1">&#39;/psn25lats_v3.dat&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="c1">#open region mask latitudes</span>
    <span class="n">shapedLons</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="n">file</span> <span class="o">=</span> <span class="n">maskLons</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;&lt;i4&#39;</span><span class="p">)</span><span class="o">/</span><span class="mf">100000.</span><span class="p">,</span> <span class="n">gridShape</span><span class="p">)</span> <span class="c1">#reshape longitudes to grid shape</span>
    <span class="n">shapedLats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="n">file</span> <span class="o">=</span> <span class="n">maskLats</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;&lt;i4&#39;</span><span class="p">)</span><span class="o">/</span><span class="mf">100000.</span><span class="p">,</span> <span class="n">gridShape</span><span class="p">)</span> <span class="c1">#reshape latitudes to grid shape</span>

    <span class="k">return</span> <span class="n">shapedMask</span><span class="p">,</span> <span class="n">shapedLons</span><span class="p">,</span> <span class="n">shapedLats</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id5">
<h4>Call function<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">regionMask</span><span class="p">,</span> <span class="n">maskLons</span><span class="p">,</span> <span class="n">maskLats</span> <span class="o">=</span> <span class="n">getRegionMask</span><span class="p">(</span><span class="n">regionMask_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="define-descriptive-information">
<h4>Define descriptive information<a class="headerlink" href="#define-descriptive-information" title="Permalink to this headline">¶</a></h4>
<p>These variables will be used later for creating the dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#coords and attributes for Region Mask</span>
<span class="n">regionMaskCoords</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;region_mask&#39;</span><span class="p">:</span> <span class="p">((</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">regionMask</span><span class="p">)}</span>
<span class="n">regionMaskKeys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">])</span>
<span class="n">regionMaskLabels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;non-region oceans&#39;</span><span class="p">,</span> <span class="s1">&#39;Sea of Okhotsk and Japan&#39;</span><span class="p">,</span><span class="s1">&#39;Bering Sea&#39;</span><span class="p">,</span><span class="s1">&#39;Hudson Bay&#39;</span><span class="p">,</span><span class="s1">&#39;Gulf of St. Lawrence&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Baffin Bay, Davis Strait &amp; Labrador Sea&#39;</span><span class="p">,</span><span class="s1">&#39;Greenland Sea&#39;</span><span class="p">,</span> <span class="s1">&#39;Barents Seas&#39;</span><span class="p">,</span><span class="s1">&#39;Kara Sea&#39;</span><span class="p">,</span><span class="s1">&#39;Laptev Sea&#39;</span><span class="p">,</span><span class="s1">&#39;East Siberian Sea&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Chukchi Sea&#39;</span><span class="p">,</span><span class="s1">&#39;Beaufort Sea&#39;</span><span class="p">,</span><span class="s1">&#39;Canadian Archipelago&#39;</span><span class="p">,</span><span class="s1">&#39;Arctic Ocean&#39;</span><span class="p">,</span><span class="s1">&#39;Land&#39;</span><span class="p">,</span><span class="s1">&#39;Coast&#39;</span><span class="p">])</span>
<span class="n">regionMaskAttrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;NSIDC region mask for the Arctic&#39;</span><span class="p">,</span> <span class="s1">&#39;keys&#39;</span><span class="p">:</span> <span class="n">regionMaskKeys</span><span class="p">,</span> <span class="s1">&#39;labels&#39;</span> <span class="p">:</span> <span class="n">regionMaskLabels</span><span class="p">,</span> <span class="s1">&#39;note&#39;</span><span class="p">:</span> <span class="s1">&#39;keys and labels ordered to match by index&#39;</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="era5-climate-reanalysis-data">
<h3>ERA5 climate reanalysis data<a class="headerlink" href="#era5-climate-reanalysis-data" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ERA5</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">ERA5_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id6">
<h4>Clean data<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h4>
<p>Clean data by removing unneccessary variables and converting temperature to Celcius</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#remove unneeded expver variable. </span>
<span class="c1">#for more info on the exper variable, see https://confluence.ecmwf.int/pages/viewpage.action?pageId=173385064</span>
<span class="n">ERA5</span> <span class="o">=</span> <span class="n">ERA5</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">expver</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ERA5</span> <span class="o">=</span> <span class="n">ERA5</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;expver&#39;</span><span class="p">)</span>

<span class="c1">#select data from past two winters </span>
<span class="n">ERA5</span> <span class="o">=</span> <span class="n">ERA5</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span> <span class="o">=</span> <span class="n">getWinterDateRange</span><span class="p">(</span><span class="mi">2018</span><span class="p">,</span> <span class="mi">2020</span><span class="p">))</span>
<span class="n">ERA5</span> <span class="o">=</span> <span class="n">ERA5</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">time</span> <span class="o">=</span> <span class="n">getWinterDateRange</span><span class="p">(</span><span class="mi">2018</span><span class="p">,</span> <span class="mi">2020</span><span class="p">))</span>

<span class="c1">#convert t2m temp to celcius </span>
<span class="n">tempCelcius</span> <span class="o">=</span> <span class="n">ERA5</span><span class="p">[</span><span class="s1">&#39;t2m&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="mf">283.15</span>
<span class="n">tempCelcius</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;C&#39;</span> <span class="c1">#change units attribute to C (Celcius)</span>
<span class="n">tempCelcius</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;long_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;2 meter temperature&#39;</span>
<span class="n">ERA5</span> <span class="o">=</span> <span class="n">ERA5</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">t2m</span> <span class="o">=</span> <span class="n">tempCelcius</span><span class="p">)</span> <span class="c1">#add to dataset as a new data variable</span>

<span class="c1">#add descriptive attributes </span>
<span class="n">ERA5</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;era5 monthly averaged data on single levels from 1979 to present&#39;</span><span class="p">,</span> 
              <span class="s1">&#39;website&#39;</span><span class="p">:</span> <span class="s1">&#39;https://cds.climate.copernicus.eu/cdsapp#!/dataset/reanalysis-era5-single-levels-monthly-means?tab=overview&#39;</span><span class="p">,</span> 
              <span class="s1">&#39;contact&#39;</span><span class="p">:</span> <span class="s1">&#39;copernicus-support@ecmwf.int&#39;</span><span class="p">,</span>
             <span class="s1">&#39;citation&#39;</span><span class="p">:</span> <span class="s1">&#39;Copernicus Climate Change Service (C3S) (2017): ERA5: Fifth generation of ECMWF atmospheric reanalyses of the global climate . Copernicus Climate Change Service Climate Data Store (CDS), July 2020. https://cds.climate.copernicus.eu/cdsapp#!/home&#39;</span><span class="p">}</span>

<span class="c1">#restrict ERA5 data to the Arctic </span>
<span class="n">ERA5</span> <span class="o">=</span> <span class="n">ERA5</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ERA5</span><span class="o">.</span><span class="n">latitude</span> <span class="o">&gt;</span> <span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="piomas-sea-ice-thickness-data">
<h3>PIOMAS sea ice thickness data<a class="headerlink" href="#piomas-sea-ice-thickness-data" title="Permalink to this headline">¶</a></h3>
<div class="section" id="define-function-to-load-the-data">
<h4>Define function to load the data<a class="headerlink" href="#define-function-to-load-the-data" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getPIOMASData</span><span class="p">(</span><span class="n">dataPath</span><span class="p">,</span> <span class="n">startYear</span> <span class="o">=</span> <span class="mi">1978</span><span class="p">,</span> <span class="n">endYear</span> <span class="o">=</span> <span class="mi">2020</span><span class="p">):</span> 
    <span class="sd">&quot;&quot;&quot;Gets PIOMAS mean monthly sea ice thickness data for an input time range. </span>
<span class="sd">    </span>
<span class="sd">    Args: </span>
<span class="sd">        dataPath (str): path to local directory of PIOMAS data </span>
<span class="sd">        startYear (int): year to start loading data from (defaul to 1978)</span>
<span class="sd">        endYear (int): year to stop loading data from (default to 2020)</span>
<span class="sd">    </span>
<span class="sd">    Returns: </span>
<span class="sd">        PIOMAS_data (xarray DataArray): PIOMAS data with descriptive coordinates and attributes</span>
<span class="sd">        </span>
<span class="sd">    Note: last available PIOMAS data was from July 2020 at the time of creation of this function</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dataList</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list for compiling data</span>

    <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">startYear</span><span class="p">,</span> <span class="n">endYear</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>     
        <span class="n">data</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">dataPath</span> <span class="o">+</span> <span class="s1">&#39;/heff.H&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">),</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> 
        <span class="k">if</span> <span class="n">year</span> <span class="o">==</span> <span class="mi">2020</span><span class="p">:</span> <span class="c1">#need special reshaping for 2020 because we dont have a full year of data</span>
            <span class="n">period</span> <span class="o">=</span> <span class="mi">7</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">period</span> <span class="o">=</span> <span class="mi">12</span>
        <span class="n">dataList</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="n">file</span> <span class="o">=</span> <span class="n">data</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;f&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="n">period</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">360</span><span class="p">]))</span>
    
    <span class="c1">#add latitude and longitude </span>
    <span class="n">gridP</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">dataPath</span> <span class="o">+</span> <span class="s1">&#39;grid.dat.txt&#39;</span><span class="p">)</span>
    <span class="n">lonsP</span> <span class="o">=</span> <span class="n">gridP</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4320</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">lonsP</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">lonsP</span><span class="p">,</span> <span class="p">[</span><span class="mi">120</span><span class="p">,</span><span class="mi">360</span><span class="p">])</span>
    <span class="n">latsP</span> <span class="o">=</span> <span class="n">gridP</span><span class="p">[</span><span class="mi">4320</span><span class="p">:,</span> <span class="p">:]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">latsP</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">latsP</span><span class="p">,</span> <span class="p">[</span><span class="mi">120</span><span class="p">,</span><span class="mi">360</span><span class="p">])</span>
    
    <span class="c1">#load dataList as an xarray DataArray with descriptive attributes and coordinates</span>
    <span class="n">time</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">startYear</span><span class="p">),</span> <span class="n">end</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">endYear</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;-07&#39;</span><span class="p">,</span> <span class="n">freq</span> <span class="o">=</span> <span class="s1">&#39;MS&#39;</span><span class="p">)</span>
    <span class="n">PIOMAS_attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;PIOMAS sea ice thickness&#39;</span><span class="p">,</span> <span class="s1">&#39;data description&#39;</span><span class="p">:</span> <span class="s1">&#39;PIOMAS monthly mean sea ice thickness&#39;</span><span class="p">,</span> <span class="s1">&#39;citation&#39;</span><span class="p">:</span> <span class="s1">&#39;Zhang, J.L. and D.A. Rothrock, “Modeling global sea ice with a thickness and enthalpy distribution model in generalized curvilinear coordinates“, Mon. Weather Rev., 131, 845-861, 2003&#39;</span><span class="p">}</span>
    <span class="n">PIOMAS_data</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">dataList</span><span class="p">,</span> <span class="n">dims</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">coords</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="n">time</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">:</span> <span class="p">((</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">lonsP</span><span class="p">),</span> <span class="s1">&#39;latitude&#39;</span><span class="p">:</span> <span class="p">((</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">latsP</span><span class="p">)},</span> <span class="n">attrs</span> <span class="o">=</span> <span class="n">PIOMAS_attrs</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">PIOMAS_data</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id7">
<h4>Call function<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">piomasData</span> <span class="o">=</span> <span class="n">getPIOMASData</span><span class="p">(</span><span class="n">PIOMAS_path</span><span class="p">,</span> <span class="n">startYear</span> <span class="o">=</span> <span class="mi">1978</span><span class="p">,</span> <span class="n">endYear</span> <span class="o">=</span> <span class="mi">2020</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="nsidc-sea-ice-drift-data">
<h3>NSIDC sea ice drift data<a class="headerlink" href="#nsidc-sea-ice-drift-data" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id8">
<h4>Define function to load the data<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getDriftData</span><span class="p">(</span><span class="n">dataPath</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Gets weekly NSIDC sea ice drift data for the Arctic, resamples monthly, and returns a dataset</span>
<span class="sd">    </span>
<span class="sd">    Args: </span>
<span class="sd">        dataPath (str): path to local directory of weekly drift data </span>

<span class="sd">    Returns: </span>
<span class="sd">        monthlyDrifts (xarray DataArray): sea ice drift data, resampled to monthly means, with descriptive coordinates and attributes</span>
<span class="sd">        </span>
<span class="sd">    Note: This function uses two different datasets from the NSIDC for drift in order to get the most recent data. Drift dataset from 1978-2018 was combined with quicklook drift dataset from 2019-present, maintaining attitributes of the 1978-2018 dataset</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">get_uv_from_xy</span><span class="p">(</span><span class="n">xdrift</span><span class="p">,</span> <span class="n">ydrift</span><span class="p">,</span> <span class="n">lon</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;convert the drift vectors to zonal/meridional, and calculate magnitude</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="n">lon</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.</span> <span class="c1">#convert longitudes to radians </span>
        <span class="n">uvelT</span> <span class="o">=</span> <span class="n">ydrift</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span> <span class="o">+</span> <span class="n">xdrift</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
        <span class="n">vvelT</span> <span class="o">=</span> <span class="n">ydrift</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span> <span class="o">-</span> <span class="n">xdrift</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
        <span class="n">vectorMag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">uvelT</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">vvelT</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">uvelT</span><span class="p">,</span> <span class="n">vvelT</span><span class="p">,</span> <span class="n">vectorMag</span>
    
    <span class="c1">#combine nc weekly files into a single xarray dataset</span>
    <span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">dataPath</span> <span class="o">+</span> <span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">dataPath</span><span class="p">)</span> <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">dataPath</span> <span class="o">+</span> <span class="n">f</span><span class="p">)</span> <span class="ow">and</span> <span class="n">f</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.nc&#39;</span><span class="p">)]</span>
    <span class="n">weeklyDrifts</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">files</span><span class="p">,</span> <span class="n">dim</span> <span class="o">=</span> <span class="s1">&#39;time&#39;</span><span class="p">)</span>

    <span class="c1">#get transformed u,v variables and add to dataset</span>
    <span class="n">uvelT</span><span class="p">,</span> <span class="n">vvelT</span><span class="p">,</span> <span class="n">vectorMag</span> <span class="o">=</span> <span class="n">get_uv_from_xy</span><span class="p">(</span><span class="n">weeklyDrifts</span><span class="o">.</span><span class="n">u</span><span class="p">,</span> <span class="n">weeklyDrifts</span><span class="o">.</span><span class="n">v</span><span class="p">,</span> <span class="n">weeklyDrifts</span><span class="o">.</span><span class="n">longitude</span><span class="p">)</span>
    <span class="n">weeklyDrifts</span> <span class="o">=</span> <span class="n">weeklyDrifts</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">drifts_uT</span> <span class="o">=</span> <span class="n">uvelT</span><span class="p">,</span> <span class="n">drifts_vT</span> <span class="o">=</span> <span class="n">vvelT</span><span class="p">,</span> <span class="n">drifts_magnitude</span> <span class="o">=</span> <span class="n">vectorMag</span><span class="p">)</span>
    
    <span class="c1">#resample to get monthly data </span>
    <span class="n">monthlyDrifts</span> <span class="o">=</span> <span class="n">weeklyDrifts</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s1">&#39;MS&#39;</span><span class="p">,</span> <span class="n">keep_attrs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

    <span class="c1">#convert to same time format as ICESat-2 </span>
    <span class="n">monthlyDrifts</span> <span class="o">=</span> <span class="n">monthlyDrifts</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">time</span> <span class="o">=</span> <span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%m-</span><span class="si">%d</span><span class="s1">-%Y&#39;</span><span class="p">))</span> <span class="k">for</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">monthlyDrifts</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">values</span><span class="p">])</span>
    
    <span class="c1">#add attributes</span>
    <span class="n">monthlyDrifts</span><span class="o">.</span><span class="n">drifts_uT</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;description&#39;</span><span class="p">:</span><span class="s1">&#39;along-x component of the ice motion (u variable) converted to zonal/meridional&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">:</span><span class="s1">&#39;cm/s&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">:</span><span class="s1">&#39;sea ice x velocity&#39;</span><span class="p">}</span>
    <span class="n">monthlyDrifts</span><span class="o">.</span><span class="n">drifts_vT</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;description&#39;</span><span class="p">:</span><span class="s1">&#39;along-y component of the ice motion (v variable) converted to zonal/meridional&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">:</span><span class="s1">&#39;cm/s&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">:</span><span class="s1">&#39;sea ice y velocity&#39;</span><span class="p">}</span>
    <span class="n">monthlyDrifts</span><span class="o">.</span><span class="n">drifts_magnitude</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;drift vector magnitude&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">:</span><span class="s1">&#39;cm/s&#39;</span><span class="p">}</span>
    <span class="n">monthlyDrifts</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;njkeeney comment&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;drift dataset from 1978-2018 was combined with quicklook drift dataset from 2019-present, maintaining attitributes of the 1978-2018 dataset&#39;</span>
    <span class="n">monthlyDrifts</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;citation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Tschudi, M., W. N. Meier, J. S. Stewart, C. Fowler, and J. Maslanik. 2019. Polar Pathfinder Daily 25 km EASE-Grid Sea Ice Motion Vectors, Version 4. Weekly sea ice motion. Boulder, Colorado USA. NASA National Snow and Ice Data Center Distributed Active Archive Center. doi: https://doi.org/10.5067/INAWUWO7QH7B. July 2020.&#39;</span>
    <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">monthlyDrifts</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span> 
        <span class="k">if</span> <span class="n">var</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;drifts_magnitude&#39;</span><span class="p">,</span><span class="s1">&#39;drifts_uT&#39;</span><span class="p">,</span> <span class="s1">&#39;drifts_vT&#39;</span><span class="p">]:</span> 
            <span class="n">monthlyDrifts</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="n">weeklyDrifts</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="c1">#resampling function causes attributes to be lost, so add them back here</span>
    
    <span class="k">return</span> <span class="n">monthlyDrifts</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id9">
<h4>Call function<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">drifts</span> <span class="o">=</span> <span class="n">getDriftData</span><span class="p">(</span><span class="n">drift_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="restrict-data-to-winter-months">
<h4>Restrict data to winter months<a class="headerlink" href="#restrict-data-to-winter-months" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">drifts</span> <span class="o">=</span> <span class="n">drifts</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span> <span class="o">=</span> <span class="n">winters</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="interpolate-missing-icesat-2-data">
<h2>Interpolate missing ICESat-2 data<a class="headerlink" href="#interpolate-missing-icesat-2-data" title="Permalink to this headline">¶</a></h2>
<p>Interpolate missing ICESat-2 data using the <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.griddata.html">scipy.griddata.interpolate</a> function and add as data variables to the dataset. Because ICESat-2 doesn’t provide full monthly coverage, interpolating fills missing grid cells with a best guess based on surrounding data. This helps avoid sampling biases when performing time series analyses, with the cavaet that this interpolation method is subjective.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#list of variables to interpolate</span>
<span class="n">IS2VarList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ice_type&#39;</span><span class="p">,</span><span class="s1">&#39;ice_thickness&#39;</span><span class="p">,</span><span class="s1">&#39;snow_depth&#39;</span><span class="p">,</span><span class="s1">&#39;freeboard&#39;</span><span class="p">,</span><span class="s1">&#39;ice_thickness_unc&#39;</span><span class="p">,</span><span class="s1">&#39;snow_density&#39;</span><span class="p">,</span><span class="s1">&#39;ice_density&#39;</span><span class="p">]</span>

<span class="c1">#go through variables in list and add as new data variables to ICESat-2 dataset</span>
<span class="k">for</span> <span class="n">varStr</span> <span class="ow">in</span> <span class="n">IS2VarList</span><span class="p">:</span>
    
    <span class="c1">#empty list to store monthly interpolated data </span>
    <span class="n">varFilled</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">month</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">is2</span><span class="o">.</span><span class="n">time</span><span class="p">)):</span> 
        <span class="c1">#current month of data </span>
        <span class="n">monthlyVar</span> <span class="o">=</span> <span class="n">is2</span><span class="p">[</span><span class="n">varStr</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">month</span><span class="p">]</span>
        
        <span class="c1">#additional condition for interpolating ice thickness</span>
        <span class="k">if</span> <span class="n">varStr</span> <span class="o">==</span> <span class="s1">&#39;ice_thickness&#39;</span><span class="p">:</span> 
            <span class="c1">#if var is ice_thickness_int, set ice_thickness to zero if ice_thickness is NaN and sea ice concentration &lt; 15%</span>
            <span class="n">monthlyVar</span><span class="p">[</span><span class="n">seaice_conc_monthly_cdr</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">month</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mf">0.15</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        
        <span class="c1">#conditions for cells to interpolate</span>
        <span class="n">monthlyVar</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked_where</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">monthlyVar</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">regionMask</span> <span class="o">!=</span> <span class="mi">20</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">regionMask</span> <span class="o">!=</span> <span class="mi">14</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">seaice_conc_monthly_cdr</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">month</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.15</span><span class="p">),</span> <span class="n">monthlyVar</span><span class="p">)</span>
        
        <span class="c1">#append interpolated data to list </span>
        <span class="n">varFilled</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">griddata</span><span class="p">((</span><span class="n">is2Lons</span><span class="p">[</span><span class="o">~</span><span class="n">monthlyVar</span><span class="o">.</span><span class="n">mask</span><span class="p">],</span> <span class="n">is2Lats</span><span class="p">[</span><span class="o">~</span><span class="n">monthlyVar</span><span class="o">.</span><span class="n">mask</span><span class="p">]),</span> 
                    <span class="n">monthlyVar</span><span class="p">[</span><span class="o">~</span><span class="n">monthlyVar</span><span class="o">.</span><span class="n">mask</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),(</span><span class="n">is2Lons</span><span class="p">,</span> <span class="n">is2Lats</span><span class="p">),</span> <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;nearest&#39;</span><span class="p">))</span>
    
    <span class="c1">#convert varFilled to a DataArray object </span>
    <span class="n">varFilledDataArray</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">varFilled</span><span class="p">,</span> <span class="n">dims</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">attrs</span> <span class="o">=</span> <span class="n">is2</span><span class="p">[</span><span class="n">varStr</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">)</span>
    <span class="n">varFilledDataArray</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;note&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;interpolated from original data&#39;</span>
    
    <span class="c1">#add as new data variable to ICESat-2 dataset</span>
    <span class="n">is2</span><span class="p">[</span><span class="n">varStr</span> <span class="o">+</span> <span class="s1">&#39;_filled&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">varFilledDataArray</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="add-descriptive-attributes-coordinates-to-all-icesat-2-variables">
<h3>Add descriptive attributes &amp; coordinates to all ICESat-2 variables<a class="headerlink" href="#add-descriptive-attributes-coordinates-to-all-icesat-2-variables" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#assign ICESat-2 dataset attributes to all variables </span>
<span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">is2</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span>
    <span class="n">is2</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="n">is2</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">assign_attrs</span><span class="p">(</span><span class="n">is2</span><span class="o">.</span><span class="n">attrs</span><span class="p">)</span>

<span class="c1">#drop lat and lon as data variables and add as coordinate values </span>
<span class="n">is2</span> <span class="o">=</span> <span class="n">is2</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">coords</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;latitude&#39;</span><span class="p">:</span> <span class="p">((</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">is2Lats</span><span class="p">),</span> <span class="s1">&#39;longitude&#39;</span><span class="p">:</span> <span class="p">((</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">is2Lons</span><span class="p">)})</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="regrid-additional-datasets-to-icesat-2-grid">
<h2>Regrid additional datasets to ICESat-2 grid<a class="headerlink" href="#regrid-additional-datasets-to-icesat-2-grid" title="Permalink to this headline">¶</a></h2>
<p>In order to merge ERA5 and PIOMAS data to the same dataset as ICESat-2, it needs to be on the same grid.</p>
<div class="section" id="define-regridding-function">
<h3>Define regridding function<a class="headerlink" href="#define-regridding-function" title="Permalink to this headline">¶</a></h3>
<p>This function will grid data to the ICESat-2 grid using the scipy.interpolate.griddata function</p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#used in code development, bar hidden in notebook outputs </span>
<span class="k">def</span> <span class="nf">progressBar</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">tot</span><span class="p">):</span> 
    <span class="sd">&quot;&quot;&quot;Display a progress bar inside a for loop </span>
<span class="sd">    Args: </span>
<span class="sd">        i (int): iteration number</span>
<span class="sd">        tot (int): total number of iterations</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">j</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">tot</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1"> [</span><span class="si">%-20s</span><span class="s1">] </span><span class="si">%d%%</span><span class="s1"> complete&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="nb">int</span><span class="p">(</span><span class="mi">20</span><span class="o">*</span><span class="n">j</span><span class="p">),</span> <span class="mi">100</span><span class="o">*</span><span class="n">j</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">regridToICESat2</span><span class="p">(</span><span class="n">dataArrayNEW</span><span class="p">,</span> <span class="n">xptsNEW</span><span class="p">,</span> <span class="n">yptsNEW</span><span class="p">,</span> <span class="n">xptsIS2</span><span class="p">,</span> <span class="n">yptsIS2</span><span class="p">):</span>  
    <span class="sd">&quot;&quot;&quot; Regrid new data to ICESat-2 grid </span>
<span class="sd">    </span>
<span class="sd">    Args: </span>
<span class="sd">        dataArrayNEW (xarray DataArray): DataArray to be gridded to ICESat-2 grid </span>
<span class="sd">        xptsNEW (numpy array): x-values of dataArrayNEW projected to ICESat-2 map projection </span>
<span class="sd">        yptsNEW (numpy array): y-values of dataArrayNEW projected to ICESat-2 map projection </span>
<span class="sd">        xptsIS2 (numpy array): ICESat-2 longitude projected to ICESat-2 map projection</span>
<span class="sd">        yptsIS2 (numpy array): ICESat-2 latitude projected to ICESat-2 map projection</span>
<span class="sd">    </span>
<span class="sd">    Returns: </span>
<span class="sd">        gridded (numpy array): data regridded to ICESat-2 map projection</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">gridded</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dataArrayNEW</span><span class="o">.</span><span class="n">values</span><span class="p">)):</span> 
        <span class="n">monthlyGridded</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">griddata</span><span class="p">((</span><span class="n">xptsNEW</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span><span class="n">yptsNEW</span><span class="o">.</span><span class="n">flatten</span><span class="p">()),</span> <span class="n">dataArrayNEW</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="p">(</span><span class="n">xptsIS2</span><span class="p">,</span> <span class="n">yptsIS2</span><span class="p">),</span> <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;nearest&#39;</span><span class="p">)</span>
        <span class="n">gridded</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">monthlyGridded</span><span class="p">)</span>
        <span class="n">progressBar</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataArrayNEW</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">gridded</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="regrid-era5-data">
<h3>Regrid ERA5 data<a class="headerlink" href="#regrid-era5-data" title="Permalink to this headline">¶</a></h3>
<div class="section" id="choose-data-variables-of-interest">
<h4>Choose data variables of interest<a class="headerlink" href="#choose-data-variables-of-interest" title="Permalink to this headline">¶</a></h4>
<p>ERA5 provides climate reananalysis data for many different variables. Here, choose data variables to maintain in the final gridded data product.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ERA5Vars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;t2m&#39;</span><span class="p">,</span><span class="s1">&#39;msdwlwrf&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;chosen variables: &#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="p">[</span><span class="n">ERA5</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;long_name&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">ERA5Vars</span><span class="p">])))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>chosen variables: 2 meter temperature, Mean surface downward long-wave radiation flux
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="regrid-era5-data-add-to-icesat-2-dataset">
<h4>Regrid ERA5 data &amp; add to ICESat-2 dataset<a class="headerlink" href="#regrid-era5-data-add-to-icesat-2-dataset" title="Permalink to this headline">¶</a></h4>
<div class="cell tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#map projection from ICESat-2 data (can be viewed in is2.projection.attrs[&#39;srid&#39;])</span>
<span class="n">IS2_proj</span> <span class="o">=</span> <span class="s1">&#39;EPSG:3411&#39;</span>

<span class="c1">#initialize map projection and project data to it</span>
<span class="n">mapProj</span> <span class="o">=</span> <span class="n">pyproj</span><span class="o">.</span><span class="n">Proj</span><span class="p">(</span><span class="s2">&quot;+init=&quot;</span> <span class="o">+</span> <span class="n">IS2_proj</span><span class="p">)</span>
<span class="n">xptsERA</span><span class="p">,</span> <span class="n">yptsERA</span> <span class="o">=</span> <span class="n">mapProj</span><span class="p">(</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">ERA5</span><span class="o">.</span><span class="n">longitude</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">ERA5</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
<span class="n">xptsIS2</span><span class="p">,</span> <span class="n">yptsIS2</span> <span class="o">=</span> <span class="n">mapProj</span><span class="p">(</span><span class="n">is2Lons</span><span class="p">,</span> <span class="n">is2Lats</span><span class="p">)</span>

<span class="c1">#grid data</span>
<span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">ERA5Vars</span><span class="p">:</span> 
    <span class="c1">#regrid data by calling function</span>
    <span class="n">ERA5gridded</span> <span class="o">=</span> <span class="n">regridToICESat2</span><span class="p">(</span><span class="n">ERA5</span><span class="p">[</span><span class="n">var</span><span class="p">],</span> <span class="n">xptsERA</span><span class="p">,</span> <span class="n">yptsERA</span><span class="p">,</span> <span class="n">xptsIS2</span><span class="p">,</span> <span class="n">yptsIS2</span><span class="p">)</span>
    
    <span class="c1">#create xarray DataArray object with descriptive coordinates </span>
    <span class="n">ERAArray</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">ERA5gridded</span><span class="p">,</span> <span class="n">dims</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">coords</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;latitude&#39;</span><span class="p">:</span> <span class="p">((</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">is2Lats</span><span class="p">),</span> <span class="s1">&#39;longitude&#39;</span><span class="p">:</span> <span class="p">((</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">is2Lons</span><span class="p">)})</span>
    <span class="n">ERAArray</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="n">ERA5</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span>
    <span class="n">ERAArray</span> <span class="o">=</span> <span class="n">ERAArray</span><span class="o">.</span><span class="n">assign_attrs</span><span class="p">(</span><span class="n">ERA5</span><span class="o">.</span><span class="n">attrs</span><span class="p">)</span>

    <span class="c1">#add to ICESat-2 dataset</span>
    <span class="n">is2</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="n">ERAArray</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="regrid-piomas-data">
<h3>Regrid PIOMAS data<a class="headerlink" href="#regrid-piomas-data" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#project data to ICESat-2 map projection</span>
<span class="n">xptsPIO</span><span class="p">,</span> <span class="n">yptsPIO</span> <span class="o">=</span> <span class="n">mapProj</span><span class="p">(</span><span class="n">piomasData</span><span class="o">.</span><span class="n">longitude</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">piomasData</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

<span class="c1">#regrid data by calling function</span>
<span class="n">PIOgridded</span> <span class="o">=</span> <span class="n">regridToICESat2</span><span class="p">(</span><span class="n">piomasData</span><span class="p">,</span> <span class="n">xptsPIO</span><span class="p">,</span> <span class="n">yptsPIO</span><span class="p">,</span> <span class="n">xptsIS2</span><span class="p">,</span> <span class="n">yptsIS2</span><span class="p">)</span>

<span class="c1">#create xarray DataArray object with descriptive coordinates </span>
<span class="n">PIOArray</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">PIOgridded</span><span class="p">,</span> <span class="n">dims</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">coords</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;latitude&#39;</span><span class="p">:</span> <span class="p">((</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">is2Lats</span><span class="p">),</span> <span class="s1">&#39;longitude&#39;</span><span class="p">:</span> <span class="p">((</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">is2Lons</span><span class="p">)})</span>
<span class="n">PIOArray</span> <span class="o">=</span> <span class="n">PIOArray</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">time</span> <span class="o">=</span> <span class="n">piomasData</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">PIOArray</span> <span class="o">=</span> <span class="n">PIOArray</span><span class="o">.</span><span class="n">assign_attrs</span><span class="p">(</span><span class="n">piomasData</span><span class="o">.</span><span class="n">attrs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="regrid-nsidc-sea-ice-drift-data">
<h3>Regrid NSIDC sea ice drift data<a class="headerlink" href="#regrid-nsidc-sea-ice-drift-data" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#project data to ICESat-2 map projection</span>
<span class="n">xptsDRIFTS</span><span class="p">,</span> <span class="n">yptsDRIFTS</span> <span class="o">=</span> <span class="n">mapProj</span><span class="p">(</span><span class="n">drifts</span><span class="o">.</span><span class="n">longitude</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">drifts</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;drifts_uT&#39;</span><span class="p">,</span> <span class="s1">&#39;drifts_vT&#39;</span><span class="p">,</span> <span class="s1">&#39;drifts_magnitude&#39;</span><span class="p">]:</span> 
    <span class="c1">#regrid data by calling function</span>
    <span class="n">driftsGridded</span> <span class="o">=</span> <span class="n">regridToICESat2</span><span class="p">(</span><span class="n">drifts</span><span class="p">[</span><span class="n">var</span><span class="p">],</span> <span class="n">xptsDRIFTS</span><span class="p">,</span> <span class="n">yptsDRIFTS</span><span class="p">,</span> <span class="n">xptsIS2</span><span class="p">,</span> <span class="n">yptsIS2</span><span class="p">)</span>
    
    <span class="c1">#create xarray DataArray object with descriptive coordinates </span>
    <span class="n">driftsArray</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">driftsGridded</span><span class="p">,</span> <span class="n">dims</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">coords</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;latitude&#39;</span><span class="p">:</span> <span class="p">((</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">is2Lats</span><span class="p">),</span> <span class="s1">&#39;longitude&#39;</span><span class="p">:</span> <span class="p">((</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">is2Lons</span><span class="p">)})</span>
    <span class="n">driftsArray</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="n">drifts</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span>
    <span class="n">driftsArray</span> <span class="o">=</span> <span class="n">driftsArray</span><span class="o">.</span><span class="n">assign_attrs</span><span class="p">(</span><span class="n">drifts</span><span class="o">.</span><span class="n">attrs</span><span class="p">)</span>

    <span class="c1">#add to ICESat-2 dataset</span>
    <span class="n">is2</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="n">driftsArray</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="save-regridded-piomas-file-to-local-directory">
<h3>Save regridded PIOMAS file to local directory<a class="headerlink" href="#save-regridded-piomas-file-to-local-directory" title="Permalink to this headline">¶</a></h3>
<p>Add region mask as descriptive coordinates to the PIOMAS regridded DataArray and save file to local directory</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#add region mask as coordinate to dataset</span>
<span class="n">piomas_to_save</span> <span class="o">=</span> <span class="n">PIOArray</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">coords</span> <span class="o">=</span> <span class="n">regionMaskCoords</span><span class="p">)</span>

<span class="c1">#add descriptive attributes </span>
<span class="n">piomas_to_save</span><span class="o">.</span><span class="n">region_mask</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="n">regionMaskAttrs</span>

<span class="c1">#create a dataset</span>
<span class="n">piomas_to_save</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">data_vars</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;PIOMAS_ice_thickness&#39;</span><span class="p">:</span> <span class="n">piomas_to_save</span><span class="p">})</span>

<span class="c1">#save to local directory as NETCDF4 file </span>
<span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;piomas-regridded-data.nc&#39;</span>
<span class="n">piomas_to_save</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="n">path</span> <span class="o">=</span> <span class="n">localDirectory</span> <span class="o">+</span> <span class="n">filename</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;NETCDF4&#39;</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;File &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> <span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39; saved to directory &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> <span class="n">localDirectory</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>File &quot;piomas-regridded-data.nc&quot; saved to directory &quot;/Users/nicolekeeney/github_repos/icesat2-book-data/&quot;
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="add-winter-regridded-piomas-data-to-icesat-2-dataset">
<h3>Add winter regridded PIOMAS data to ICESat-2 dataset<a class="headerlink" href="#add-winter-regridded-piomas-data-to-icesat-2-dataset" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#restrict data to same time period as ICESat-2</span>
<span class="n">PIOArray</span> <span class="o">=</span> <span class="n">PIOArray</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span> <span class="o">=</span> <span class="n">winters</span><span class="p">)</span>

<span class="c1">#add to ICESat-2 dataset</span>
<span class="n">is2</span><span class="p">[</span><span class="s1">&#39;PIOMAS_ice_thickness&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PIOArray</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="compile-datasets-into-a-single-dataset">
<h2>Compile datasets into a single Dataset<a class="headerlink" href="#compile-datasets-into-a-single-dataset" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#add region mask as coordinate to dataset</span>
<span class="n">is2</span> <span class="o">=</span> <span class="n">is2</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">coords</span> <span class="o">=</span> <span class="n">regionMaskCoords</span><span class="p">)</span>

<span class="c1">#add descriptive attributes </span>
<span class="n">is2</span><span class="o">.</span><span class="n">region_mask</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="n">regionMaskAttrs</span>
<span class="n">is2</span><span class="o">.</span><span class="n">longitude</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="n">is2LonsAttrs</span>
<span class="n">is2</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="n">is2LatsAttrs</span>
<span class="n">is2</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;description&#39;</span><span class="p">:</span><span class="s1">&#39;data used in nicolejkeeney ICESat-2 jupyter book&#39;</span><span class="p">,</span> <span class="s1">&#39;note&#39;</span><span class="p">:</span> <span class="s1">&#39;see individual data variables for references&#39;</span><span class="p">,</span> <span class="s1">&#39;creation date&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">())}</span>

<span class="nb">print</span><span class="p">(</span><span class="n">is2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;xarray.Dataset&gt;
Dimensions:                   (time: 12, x: 448, y: 304)
Coordinates:
  * time                      (time) datetime64[ns] 2018-11-01 ... 2020-04-01
    longitude                 (x, y) float32 168.32042 168.14876 ... -9.998976
    latitude                  (x, y) float32 31.102673 31.199413 ... 34.472084
    region_mask               (x, y) uint8 1 1 1 1 1 1 1 1 1 ... 1 1 1 1 1 1 1 1
Dimensions without coordinates: x, y
Data variables:
    xgrid                     (time, x, y) float32 -3837500.0 ... 3737500.0
    ygrid                     (time, x, y) float32 5837500.0 ... -5337500.0
    ice_thickness             (time, x, y) float32 0.0 0.0 0.0 ... 0.0 0.0 0.0
    ice_thickness_unc         (time, x, y) float32 nan nan nan ... nan nan nan
    num_segments              (time, x, y) float32 nan nan nan ... nan nan nan
    mean_day_of_month         (time, x, y) float32 nan nan nan ... nan nan nan
    snow_depth                (time, x, y) float32 nan nan nan ... nan nan nan
    snow_density              (time, x, y) float32 nan nan nan ... nan nan nan
    freeboard                 (time, x, y) float32 nan nan nan ... nan nan nan
    ice_type                  (time, x, y) float32 nan nan nan ... nan nan nan
    ice_density               (time, x, y) float32 nan nan nan ... nan nan nan
    seaice_conc_monthly_cdr   (time, x, y) float32 0.0 0.0 0.0 ... 0.0 0.0 0.0
    ice_type_filled           (time, x, y) float32 nan nan nan ... nan nan nan
    ice_thickness_filled      (time, x, y) float32 0.0 0.0 0.0 ... 0.0 0.0 0.0
    snow_depth_filled         (time, x, y) float32 nan nan nan ... nan nan nan
    freeboard_filled          (time, x, y) float32 nan nan nan ... nan nan nan
    ice_thickness_unc_filled  (time, x, y) float32 nan nan nan ... nan nan nan
    snow_density_filled       (time, x, y) float32 nan nan nan ... nan nan nan
    ice_density_filled        (time, x, y) float32 nan nan nan ... nan nan nan
    t2m                       (time, x, y) float32 nan nan nan ... nan nan nan
    msdwlwrf                  (time, x, y) float32 nan nan nan ... nan nan nan
    drifts_uT                 (time, x, y) float32 nan nan nan ... nan nan nan
    drifts_vT                 (time, x, y) float32 nan nan nan ... nan nan nan
    drifts_magnitude          (time, x, y) float32 nan nan nan ... nan nan nan
    PIOMAS_ice_thickness      (time, x, y) float32 0.0 0.0 0.0 ... 0.0 0.0 0.0
Attributes:
    description:    data used in nicolejkeeney ICESat-2 jupyter book
    note:           see individual data variables for references
    creation date:  2020-11-18
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="save-dataset-to-your-local-machine">
<h2>Save dataset to your local machine<a class="headerlink" href="#save-dataset-to-your-local-machine" title="Permalink to this headline">¶</a></h2>
<p>We will use this dataset in other notebooks to plot and analyze the data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;icesat2-book-data.nc&#39;</span>
<span class="n">is2</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="n">path</span> <span class="o">=</span> <span class="n">localDirectory</span> <span class="o">+</span> <span class="n">filename</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;NETCDF4&#39;</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;File &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> <span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39; saved to directory &#39;</span> <span class="o">+</span> <span class="s1">&#39;&quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> <span class="n">localDirectory</span><span class="p">)</span>
<span class="n">is2</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>File &quot;icesat2-book-data.nc&quot; saved to directory &quot;/Users/nicolekeeney/github_repos/icesat2-book-data/&quot;
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="ice_drift.html" title="previous page">Sea ice drift</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Nicole Keeney<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="_static/js/index.js"></script>
    
    <!-- Google Analytics -->
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-177768395-1', 'auto');
      ga('set', 'anonymizeIp', true);
      ga('send', 'pageview');
    </script>
    <script async src='https://www.google-analytics.com/analytics.js'></script>
    <!-- End Google Analytics -->
    
  </body>
</html>